#shodan exploit search

import shodan
import sys
import json
from ConfigParser import ConfigParser


#grab the api key from auth.ini
config = ConfigParser()
config.read('auth.ini')
SHODAN_API_KEY = config.get('auth','API_KEY')

#initialize the api object
api = shodan.Shodan(SHODAN_API_KEY)\

# Input validation
if len(sys.argv) == 1:
        print 'Usage: %s <search query>' % sys.argv[0]
        sys.exit(1)

try:

        query = ' '.join(sys.argv[1:])
        results = api.exploits.search(query)
        count=0
        while count <= 10:
            print str(json.dumps(results['matches'][count]['cve'])).strip('[').strip(']').strip("\"")
            count+=1

except Exception, e:
        print 'Error: %s' % e
        sys.exit(1)
